<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –º–∏–∫—Ä–æ—Ä–∞–∑–º–µ—Ç–∫–∏ —Å–æ Schema.org</title>
  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,500,700&display=swap" rel="stylesheet">
  <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
  <!-- Socket.IO –∫–ª–∏–µ–Ω—Ç -->
  <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
</head>
<body>
<div class="container">
  <h1 class="text-center mb-4"><i class="bi bi-code-square schema-icon"></i>iSEO Schema Generator</h1>
  
  <!-- –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É "–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥" –≤–≤–µ—Ä—Ö—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
  <div class="mb-3">
    <a href="/" class="btn btn-outline-secondary">
      <i class="bi bi-arrow-left me-2"></i>–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥
    </a>
  </div>
  
  <div class="schema-info">
    <p>–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è SEO-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤, –≥–µ–Ω–µ—Ä–∏—Ä—É—é—â–∏–π –º–∏–∫—Ä–æ—Ä–∞–∑–º–µ—Ç–∫—É Schema.org –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ —Å–∞–π—Ç–∞. <strong>AI —Å —Ñ—É–Ω–∫—Ü–∏–µ–π –≤–µ–±-–ø–æ–∏—Å–∫–∞ —Å–æ–∑–¥–∞—ë—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –º–∏–∫—Ä–æ—Ä–∞–∑–º–µ—Ç–∫—É, –æ—Å–Ω–æ–≤–∞–Ω–Ω—É—é –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–º.</strong></p>
    <div class="alert alert-info">
      <i class="bi bi-lightbulb-fill me-2"></i>
      <strong>Pro tip:</strong> –î–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ URL —Å—Ç—Ä–∞–Ω–∏—Ü—ã, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π —Ç–∏–ø—É –º–∏–∫—Ä–æ—Ä–∞–∑–º–µ—Ç–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, URL —Ç–æ–≤–∞—Ä–∞ –¥–ª—è Product).
    </div>
  </div>
  
  <ul class="nav nav-tabs" id="schemaTabs" role="tablist">
    <li class="nav-item" role="presentation">
      <button class="nav-link active" id="single-tab" data-bs-toggle="tab" data-bs-target="#single-schema" type="button" role="tab" aria-controls="single-schema" aria-selected="true">–ï–¥–∏–Ω–∏—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è</button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" id="all-tab" data-bs-toggle="tab" data-bs-target="#all-schemas" type="button" role="tab" aria-controls="all-schemas" aria-selected="false">–ü–æ–ª–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Ç</button>
    </li>
  </ul>
  
  <div class="tab-content" id="schemaTabContent">
    <!-- –í–∫–ª–∞–¥–∫–∞ —Å –æ–¥–∏–Ω–æ—á–Ω—ã–º —à–∞–±–ª–æ–Ω–æ–º -->
    <div class="tab-pane fade show active" id="single-schema" role="tabpanel" aria-labelledby="single-tab">
      <form id="templateForm">
        <div class="form-floating mb-3">
          <select class="form-select" id="element_type" name="element_type">
            {% for key, value in element_types.items() %}
              <option value="{{ key }}">{{ value }}</option>
            {% endfor %}
          </select>
          <label for="element_type">–¢–∏–ø —ç–ª–µ–º–µ–Ω—Ç–∞</label>
        </div>
        <div class="form-floating mb-3">
          <input type="url" class="form-control" id="url" name="url" placeholder="https://example.com" required>
          <label for="url">URL —Å–∞–π—Ç–∞</label>
          <div class="form-text">–í–≤–µ–¥–∏—Ç–µ –ø–æ–ª–Ω—ã–π URL —Å https:// –∏–ª–∏ http:// —Å—Ç—Ä–∞–Ω–∏—Ü—ã, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π –Ω—É–∂–Ω–∞ –º–∏–∫—Ä–æ—Ä–∞–∑–º–µ—Ç–∫–∞</div>
        </div>
        <div class="d-grid">
          <button type="submit" class="btn btn-primary btn-lg" id="generateBtn">
            <i class="bi bi-code-square me-2"></i> –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –º–∏–∫—Ä–æ—Ä–∞–∑–º–µ—Ç–∫—É
          </button>
        </div>
      </form>
      
      <div class="alert alert-danger mt-3" id="errorBlock" style="display:none;"></div>
      
      <!-- –ë–ª–æ–∫ —Å—Ç–∞—Ç—É—Å–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ -->
      <div class="status-container" id="statusContainer" style="display:none;">
        <div class="card mt-4">
          <div class="card-header d-flex justify-content-between align-items-center">
            <h5 class="mb-0">
              <i class="bi bi-hourglass-split me-2"></i>–°—Ç–∞—Ç—É—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
            </h5>
            <span class="badge bg-primary" id="statusBadge">–û–∂–∏–¥–∞–Ω–∏–µ</span>
          </div>
          <div class="card-body">
            <div class="status-message" id="statusMessage">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –∞–Ω–∞–ª–∏–∑—É —Å–∞–π—Ç–∞...</div>
            
            <div class="progress mt-3">
              <div class="progress-bar progress-bar-striped progress-bar-animated" id="progressBar" 
                   role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div>
            </div>
            
            <div class="d-flex justify-content-between mt-2">
              <small id="elapsedTime">–ü—Ä–æ—à–ª–æ: 0 —Å–µ–∫</small>
              <small id="estimatedTime">–ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è: 20-30 —Å–µ–∫</small>
            </div>
            
            <div class="generation-steps mt-3">
              <div class="step" id="step1">
                <i class="bi bi-1-circle me-2"></i>
                <span>–ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–∞–π—Ç–∞</span>
                <small class="status-indicator">–æ–∂–∏–¥–∞–Ω–∏–µ</small>
              </div>
              <div class="step" id="step2">
                <i class="bi bi-2-circle me-2"></i>
                <span>–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã</span>
                <small class="status-indicator">–æ–∂–∏–¥–∞–Ω–∏–µ</small>
              </div>
              <div class="step" id="step3">
                <i class="bi bi-3-circle me-2"></i>
                <span>–°–æ–∑–¥–∞–Ω–∏–µ –º–∏–∫—Ä–æ—Ä–∞–∑–º–µ—Ç–∫–∏</span>
                <small class="status-indicator">–æ–∂–∏–¥–∞–Ω–∏–µ</small>
              </div>
              <div class="step" id="step4">
                <i class="bi bi-4-circle me-2"></i>
                <span>–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è</span>
                <small class="status-indicator">–æ–∂–∏–¥–∞–Ω–∏–µ</small>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="loading-spinner" id="spinner" style="display:none;">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
        </div>
        <p class="mt-2">AI –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤–∞—à —Å–∞–π—Ç –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏...</p>
        <p class="text-muted small">–≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –¥–æ 30 —Å–µ–∫—É–Ω–¥, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ–±—ä—ë–º–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–∞–π—Ç–µ</p>
      </div>
      
      <div class="mt-4" id="resultContainer" style="display:none;">
        <div class="result-header">
          <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç:</h3>
          <button id="copyBtn" class="btn btn-sm btn-outline-secondary">
            <i class="bi bi-clipboard"></i> –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
          </button>
        </div>
        <pre id="resultBlock" class="p-3 bg-light border rounded"></pre>
        
        <!-- –î–æ–±–∞–≤–ª—è–µ–º –±–ª–æ–∫ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –¥–ª—è –µ–¥–∏–Ω–∏—á–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ -->
        <div class="snippet-preview my-3 p-3 border rounded">
          <h6 class="snippet-preview-title mb-3">
            <i class="bi bi-eye me-2"></i>–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä Rich Snippets:
            <span class="badge bg-info ms-2">Google</span>
            <button class="btn btn-sm btn-outline-primary float-end" id="editSnippetBtn">
              <i class="bi bi-pencil-square"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
            </button>
          </h6>
          <div class="snippet-container p-3 border rounded bg-white" id="singleSnippet">
            <!-- –ó–¥–µ—Å—å –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å–Ω–∏–ø–ø–µ—Ç–∞ -->
            <div class="google-snippet-placeholder text-center py-3">
              <i class="bi bi-hourglass-split text-muted me-2"></i>
              <span class="text-muted">–°–Ω–∏–ø–ø–µ—Ç –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏</span>
            </div>
          </div>
          
          <!-- –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–Ω–∏–ø–ø–µ—Ç–∞ -->
          <div id="snippetEditForm" class="mt-3 border rounded p-3 bg-light" style="display:none;">
            <h6 class="mb-3"><i class="bi bi-pencil me-2"></i>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–Ω–∏–ø–ø–µ—Ç–∞</h6>
            
            <div class="mb-3">
              <label for="snippetTitle" class="form-label">–ó–∞–≥–æ–ª–æ–≤–æ–∫:</label>
              <input type="text" class="form-control" id="snippetTitle">
            </div>
            
            <div class="mb-3">
              <label for="snippetUrl" class="form-label">URL:</label>
              <input type="text" class="form-control" id="snippetUrl">
            </div>
            
            <div class="mb-3">
              <label for="snippetDescription" class="form-label">–û–ø–∏—Å–∞–Ω–∏–µ:</label>
              <textarea class="form-control" id="snippetDescription" rows="3"></textarea>
            </div>
            
            <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–Ω–∏–ø–ø–µ—Ç–æ–≤ -->
            <div id="additionalFields"></div>
            
            <div class="mt-3">
              <button type="button" class="btn btn-primary" id="applySnippetChangesBtn">
                <i class="bi bi-check-lg me-1"></i> –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
              </button>
              <button type="button" class="btn btn-outline-secondary ms-2" id="cancelSnippetEditBtn">
                <i class="bi bi-x me-1"></i> –û—Ç–º–µ–Ω–∞
              </button>
            </div>
          </div>
          
          <div class="snippet-notice text-center text-muted small mt-2">
            <i class="bi bi-info-circle me-1"></i>–≠—Ç–æ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω—ã–π –≤–∏–¥ —Å–Ω–∏–ø–ø–µ—Ç–∞. –§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è.
          </div>
        </div>
      </div>
    </div>
    
    <!-- –í–∫–ª–∞–¥–∫–∞ —Å–æ –≤—Å–µ–º–∏ —à–∞–±–ª–æ–Ω–∞–º–∏ -->
    <div class="tab-pane fade" id="all-schemas" role="tabpanel" aria-labelledby="all-tab">
      <form action="/results" method="post">
        <div class="form-floating mb-3">
          <input type="url" class="form-control" id="allUrl" name="url" placeholder="https://example.com" required>
          <label for="allUrl">URL —Å–∞–π—Ç–∞</label>
          <div class="form-text">–í–≤–µ–¥–∏—Ç–µ –ø–æ–ª–Ω—ã–π URL —Å https:// –∏–ª–∏ http:// –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å–∞–π—Ç–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</div>
        </div>
        <div class="alert alert-warning mb-3">
          <i class="bi bi-info-circle-fill me-2"></i>
          –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –º–∏–∫—Ä–æ—Ä–∞–∑–º–µ—Ç–∫–∏ –∑–∞–π–º–µ—Ç –æ–∫–æ–ª–æ 2-3 –º–∏–Ω—É—Ç
        </div>
        <div class="d-grid">
          <button type="submit" class="btn btn-success btn-lg btn-generate-all">
            <i class="bi bi-code-square me-2"></i> –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π –∫–æ–º–ø–ª–µ–∫—Ç
          </button>
        </div>
      </form>
      
      <!-- –ë–ª–æ–∫ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤—Å–µ—Ö —à–∞–±–ª–æ–Ω–æ–≤ -->
      <div class="card mt-4" id="allProgressCard" style="display:none;">
        <div class="card-header">
          <h5 class="mb-0"><i class="bi bi-list-check me-2"></i>–ü—Ä–æ–≥—Ä–µ—Å—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏</h5>
        </div>
        <div class="card-body">
          <div class="progress mb-3">
            <div class="progress-bar progress-bar-striped progress-bar-animated bg-success" id="allProgressBar" 
                 role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"></div>
          </div>
          
          <div id="allProgressStats" class="text-center mb-3">
            <span id="completedCount">0</span> –∏–∑ <span id="totalTypes">{{ element_types|length }}</span> —à–∞–±–ª–æ–Ω–æ–≤
          </div>
          
          <div class="current-task" id="currentTask">
            –û–∂–∏–¥–∞–Ω–∏–µ –Ω–∞—á–∞–ª–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏...
          </div>
          
          <div class="completed-tasks mt-3" id="completedTasks">
            <h6>–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã:</h6>
            <ul class="list-group" id="completedList">
              <!-- –°—é–¥–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ -->
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="text-center mt-4">
    <small class="text-muted">
      iSEO Schema Generator ‚Äî –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è SEO-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤
    </small>
  </div>
  
  <div class="features-section mt-5 mb-3">
    <h4 class="text-center mb-4">–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –¥–ª—è SEO-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤</h4>
    <div class="row g-4">
      <div class="col-md-4">
        <div class="card h-100">
          <div class="card-body">
            <h5 class="card-title"><i class="bi bi-search text-primary me-2"></i>–¢–æ—á–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö</h5>
            <p class="card-text">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Å–∞–π—Ç–∞ –∏–∑–≤–ª–µ–∫–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ: –Ω–∞–∑–≤–∞–Ω–∏—è, —Ü–µ–Ω—ã, –∞–¥—Ä–µ—Å–∞ –∏ –¥—Ä—É–≥—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞.</p>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card h-100">
          <div class="card-body">
            <h5 class="card-title"><i class="bi bi-lightning-charge text-primary me-2"></i>–°–∫–æ—Ä–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã</h5>
            <p class="card-text">–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≥–æ—Ç–æ–≤–æ–π –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –º–∏–∫—Ä–æ—Ä–∞–∑–º–µ—Ç–∫–∏ –∑–∞–Ω–∏–º–∞–µ—Ç —Å–µ–∫—É–Ω–¥—ã –≤–º–µ—Å—Ç–æ –º–∏–Ω—É—Ç —Ä—É—á–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è, —á—Ç–æ —ç–∫–æ–Ω–æ–º–∏—Ç –≤—Ä–µ–º—è SEO-—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞.</p>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card h-100">
          <div class="card-body">
            <h5 class="card-title"><i class="bi bi-eye text-primary me-2"></i>–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</h5>
            <p class="card-text">–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–Ω–∏–ø–ø–µ—Ç–æ–≤ –ø–æ–º–æ–≥–∞–µ—Ç –æ—Ü–µ–Ω–∏—Ç—å, –∫–∞–∫ –º–∏–∫—Ä–æ—Ä–∞–∑–º–µ—Ç–∫–∞ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö –ø–æ–∏—Å–∫–∞, –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –Ω–∞ —Å–∞–π—Ç.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Bootstrap JS Bundle -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Socket.IO
  const socket = io();
  let sessionId = null;
  let startTime = null;
  let timerInterval = null;
  
  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞
  function updateTimer() {
    if (!startTime) return;
    
    const elapsedTime = Math.floor((Date.now() - startTime) / 1000);
    document.getElementById('elapsedTime').textContent = `–ü—Ä–æ—à–ª–æ: ${elapsedTime} —Å–µ–∫`;
  }
  
  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —à–∞–≥–æ–≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
  function updateSteps(step, status) {
    const steps = {
      1: 'step1',
      2: 'step2',
      3: 'step3',
      4: 'step4'
    };
    
    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ —à–∞–≥–∏ –¥–æ —Ç–µ–∫—É—â–µ–≥–æ
    for (let i = 1; i <= 4; i++) {
      const stepEl = document.getElementById(steps[i]);
      const statusEl = stepEl.querySelector('.status-indicator');
      
      if (i < step) {
        statusEl.textContent = '–∑–∞–≤–µ—Ä—à–µ–Ω–æ';
        statusEl.className = 'status-indicator text-success';
        stepEl.classList.add('completed');
      } else if (i === step) {
        statusEl.textContent = status;
        statusEl.className = 'status-indicator text-primary';
        stepEl.classList.add('current');
      } else {
        statusEl.textContent = '–æ–∂–∏–¥–∞–Ω–∏–µ';
        statusEl.className = 'status-indicator';
        stepEl.classList.remove('completed', 'current');
      }
    }
  }
  
  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π Socket.IO
  socket.on('connect', () => {
    console.log('Connected to server');
  });
  
  socket.on('generation_status', (data) => {
    if (data.session_id !== sessionId) return;
    
    console.log('Generation status:', data);
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ç–∞—Ç—É—Å–∞
    const statusBadge = document.getElementById('statusBadge');
    const statusMessage = document.getElementById('statusMessage');
    const progressBar = document.getElementById('progressBar');
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
    statusMessage.textContent = data.message;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ —Å—Ç–∞—Ç—É—Å
    switch(data.status) {
      case 'started':
        statusBadge.textContent = '–ê–Ω–∞–ª–∏–∑';
        statusBadge.className = 'badge bg-info';
        progressBar.style.width = '25%';
        progressBar.setAttribute('aria-valuenow', 25);
        updateSteps(1, '–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è');
        break;
      case 'processing':
        statusBadge.textContent = '–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö';
        statusBadge.className = 'badge bg-primary';
        progressBar.style.width = '50%';
        progressBar.setAttribute('aria-valuenow', 50);
        updateSteps(2, '–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è');
        
        // –ß–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã –æ–±–Ω–æ–≤–ª—è–µ–º –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞
        setTimeout(() => {
          progressBar.style.width = '75%';
          progressBar.setAttribute('aria-valuenow', 75);
          updateSteps(3, '–≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è');
          statusMessage.textContent = '–°–æ–∑–¥–∞–Ω–∏–µ –º–∏–∫—Ä–æ—Ä–∞–∑–º–µ—Ç–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö —Å —Å–∞–π—Ç–∞...';
        }, 2000);
        break;
      case 'completed':
        statusBadge.textContent = '–ó–∞–≤–µ—Ä—à–µ–Ω–æ';
        statusBadge.className = 'badge bg-success';
        progressBar.style.width = '100%';
        progressBar.setAttribute('aria-valuenow', 100);
        progressBar.classList.remove('progress-bar-animated');
        updateSteps(4, '–∑–∞–≤–µ—Ä—à–µ–Ω–æ');
        break;
      case 'error':
        statusBadge.textContent = '–û—à–∏–±–∫–∞';
        statusBadge.className = 'badge bg-danger';
        progressBar.style.width = '100%';
        progressBar.classList.remove('progress-bar-animated');
        progressBar.classList.add('bg-danger');
        progressBar.setAttribute('aria-valuenow', 100);
        break;
    }
  });
  
  socket.on('generation_result', (data) => {
    if (data.session_id !== sessionId) return;
    
    console.log('Generation result:', data);
    
    // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∞–π–º–µ—Ä
    if (timerInterval) {
      clearInterval(timerInterval);
    }
    
    // –°–∫—Ä—ã–≤–∞–µ–º —Å–ø–∏–Ω–Ω–µ—Ä –∏ –±–ª–æ–∫ —Å—Ç–∞—Ç—É—Å–∞
    document.getElementById('spinner').style.display = 'none';
    document.getElementById('statusContainer').style.display = 'none';
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    document.getElementById('resultBlock').textContent = data.result;
    document.getElementById('resultContainer').style.display = 'block';
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å–Ω–∏–ø–ø–µ—Ç–∞
    updateSingleSnippetPreview(data.result, data.domain);
    
    // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
    document.getElementById('generateBtn').disabled = false;
  });
  
  socket.on('generation_error', (data) => {
    if (data.session_id !== sessionId) return;
    
    console.log('Generation error:', data);
    
    // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∞–π–º–µ—Ä
    if (timerInterval) {
      clearInterval(timerInterval);
    }
    
    // –°–∫—Ä—ã–≤–∞–µ–º —Å–ø–∏–Ω–Ω–µ—Ä –∏ –±–ª–æ–∫ —Å—Ç–∞—Ç—É—Å–∞
    document.getElementById('spinner').style.display = 'none';
    document.getElementById('statusContainer').style.display = 'none';
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
    const errorBlock = document.getElementById('errorBlock');
    errorBlock.textContent = `–û—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –º–∏–∫—Ä–æ—Ä–∞–∑–º–µ—Ç–∫–∏: ${data.error}`;
    errorBlock.style.display = 'block';
    
    // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
    document.getElementById('generateBtn').disabled = false;
  });
  
  // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤—Å–µ—Ö —à–∞–±–ª–æ–Ω–æ–≤
  socket.on('generation_progress', (data) => {
    // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
    const progressBar = document.getElementById('allProgressBar');
    const completedCount = document.getElementById('completedCount');
    const currentTask = document.getElementById('currentTask');
    const completedList = document.getElementById('completedList');
    
    // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
    const percent = Math.floor((data.progress / data.total) * 100);
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä
    progressBar.style.width = `${percent}%`;
    progressBar.setAttribute('aria-valuenow', percent);
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫
    completedCount.textContent = data.progress;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—É—â—É—é –∑–∞–¥–∞—á—É
    currentTask.textContent = `–ì–µ–Ω–µ—Ä–∞—Ü–∏—è: ${data.current}`;
    
    // –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—É—é –∑–∞–¥–∞—á—É –≤ —Å–ø–∏—Å–æ–∫
    if (data.completed && data.completed.length > 0) {
      const lastCompleted = data.completed[data.completed.length - 1];
      const listItem = document.createElement('li');
      listItem.className = 'list-group-item d-flex justify-content-between align-items-center';
      listItem.innerHTML = `
        ${lastCompleted} 
        <span class="badge bg-success"><i class="bi bi-check"></i></span>
      `;
      completedList.appendChild(listItem);
    }
  });
  
  socket.on('all_generation_result', (data) => {
    // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
    window.location.href = `/get-results/${data.session_id}`;
  });
  
  // –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã —á–µ—Ä–µ–∑ AJAX
  document.getElementById('templateForm').addEventListener('submit', function(e) {
    e.preventDefault();
    
    // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    document.getElementById('errorBlock').style.display = 'none';
    document.getElementById('resultContainer').style.display = 'none';
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–ª–æ–∫–∏ —Å—Ç–∞—Ç—É—Å–∞
    document.getElementById('statusContainer').style.display = 'block';
    document.getElementById('spinner').style.display = 'block';
    
    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Å—Ç–∞—Ç—É—Å–∞
    document.getElementById('statusBadge').textContent = '–û–∂–∏–¥–∞–Ω–∏–µ';
    document.getElementById('statusBadge').className = 'badge bg-secondary';
    document.getElementById('progressBar').style.width = '0%';
    document.getElementById('progressBar').setAttribute('aria-valuenow', 0);
    document.getElementById('progressBar').classList.add('progress-bar-animated');
    document.getElementById('progressBar').classList.remove('bg-danger');
    
    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —à–∞–≥–∏
    updateSteps(1, '–æ–∂–∏–¥–∞–Ω–∏–µ');
    
    const element_type = document.getElementById('element_type').value;
    const url = document.getElementById('url').value;
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ URL
    if (!url.startsWith('http://') && !url.startsWith('https://')) {
      document.getElementById('errorBlock').textContent = 'URL –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å http:// –∏–ª–∏ https://';
      document.getElementById('errorBlock').style.display = 'block';
      document.getElementById('statusContainer').style.display = 'none';
      document.getElementById('spinner').style.display = 'none';
      return;
    }
    
    // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä
    startTime = Date.now();
    if (timerInterval) {
      clearInterval(timerInterval);
    }
    timerInterval = setInterval(updateTimer, 1000);
    
    // –û—Ç–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É –Ω–∞ –≤—Ä–µ–º—è –∑–∞–ø—Ä–æ—Å–∞
    const generateBtn = document.getElementById('generateBtn');
    generateBtn.disabled = true;
    
    fetch('/generate-template', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({element_type, url})
    })
    .then(response => response.json())
    .then(data => {
      if (data.error) {
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
        document.getElementById('errorBlock').textContent = data.error;
        document.getElementById('errorBlock').style.display = 'block';
        document.getElementById('statusContainer').style.display = 'none';
        document.getElementById('spinner').style.display = 'none';
        generateBtn.disabled = false;
      } else {
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º ID —Å–µ—Å—Å–∏–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏–π
        sessionId = data.session_id;
        console.log('Session ID:', sessionId);
      }
    })
    .catch(error => {
      console.error('–û—à–∏–±–∫–∞:', error);
      document.getElementById('spinner').style.display = 'none';
      document.getElementById('statusContainer').style.display = 'none';
      document.getElementById('errorBlock').textContent = '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–∞';
      document.getElementById('errorBlock').style.display = 'block';
      generateBtn.disabled = false;
    });
  });

  // –ö–Ω–æ–ø–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
  document.getElementById('copyBtn').addEventListener('click', function() {
    const resultText = document.getElementById('resultBlock').textContent;
    navigator.clipboard.writeText(resultText).then(() => {
      this.innerHTML = '<i class="bi bi-check2"></i> –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
      setTimeout(() => { 
        this.innerHTML = '<i class="bi bi-clipboard"></i> –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å';
      }, 2000);
    }).catch(err => {
      console.error('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è: ', err);
      this.innerHTML = '<i class="bi bi-exclamation-triangle"></i> –û—à–∏–±–∫–∞';
      setTimeout(() => { 
        this.innerHTML = '<i class="bi bi-clipboard"></i> –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å';
      }, 2000);
    });
  });
  
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ—Ä–º—ã –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤—Å–µ—Ö —à–∞–±–ª–æ–Ω–æ–≤
  const allSchemaForm = document.querySelector('#all-schemas form');
  allSchemaForm.addEventListener('submit', function(e) {
    e.preventDefault();
    
    const url = document.getElementById('allUrl').value;
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ URL
    if (!url.startsWith('http://') && !url.startsWith('https://')) {
      alert('URL –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å http:// –∏–ª–∏ https://');
      return;
    }
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–ª–æ–∫ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
    document.getElementById('allProgressCard').style.display = 'block';
    
    // –û—Ç–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É
    const generateBtn = document.querySelector('.btn-generate-all');
    generateBtn.disabled = true;
    
    // –û—á–∏—â–∞–µ–º —Å–ø–∏—Å–æ–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á
    document.getElementById('completedList').innerHTML = '';
    document.getElementById('completedCount').textContent = '0';
    
    fetch('/generate-all', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({url})
    })
    .then(response => response.json())
    .then(data => {
      if (data.error) {
        alert(data.error);
        generateBtn.disabled = false;
        document.getElementById('allProgressCard').style.display = 'none';
      } else {
        sessionId = data.session_id;
        console.log('Session ID for all templates:', sessionId);
      }
    })
    .catch(error => {
      console.error('–û—à–∏–±–∫–∞:', error);
      alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–∞');
      generateBtn.disabled = false;
      document.getElementById('allProgressCard').style.display = 'none';
    });
  });

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–Ω–∏–ø–ø–µ—Ç–∞ –ø—Ä–∏ –µ–¥–∏–Ω–∏—á–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
  function updateSingleSnippetPreview(jsonLdCode, serverDomain) {
    const snippetContainer = document.getElementById('singleSnippet');
    if (!snippetContainer) return;
    
    try {
      // –ò–∑–≤–ª–µ–∫–∞–µ–º JSON-LD –∏–∑ –∫–æ–¥–∞
      const jsonMatch = jsonLdCode.match(/<script type="application\/ld\+json">([\s\S]*?)<\/script>/);
      
      if (jsonMatch && jsonMatch[1]) {
        const jsonData = JSON.parse(jsonMatch[1].trim());
        const type = jsonData['@type'];
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–∏–ø —Å–Ω–∏–ø–ø–µ—Ç–∞ –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        currentSnippetType = type;
        currentSnippetData = jsonData;
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç—Ç–æ—Ç —Ç–∏–ø —Ç–µ–º, —á—Ç–æ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ —Å–Ω–∏–ø–ø–µ—Ç–µ
        const nonVisibleTypes = ['Organization', 'WebSite', 'ImageObject'];
        if (nonVisibleTypes.includes(type)) {
          snippetContainer.innerHTML = `
            <div class="google-snippet text-center">
              <div class="py-3">
                <i class="bi bi-info-circle text-muted me-2"></i>
                <span class="text-muted">–≠—Ç–æ—Ç —Ç–∏–ø –º–∏–∫—Ä–æ—Ä–∞–∑–º–µ—Ç–∫–∏ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ –ø–æ–∏—Å–∫–æ–≤–æ–π –≤—ã–¥–∞—á–µ</span>
              </div>
            </div>
          `;
          return;
        }
        
        // –ü–æ–ª—É—á–∞–µ–º –¥–æ–º–µ–Ω–Ω–æ–µ –∏–º—è –∏–∑ URL, –≤–≤–µ–¥–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –∏–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–æ–º
        let domain = serverDomain || '';
        
        // –ï—Å–ª–∏ –¥–æ–º–µ–Ω –Ω–µ –±—ã–ª –ø–µ—Ä–µ–¥–∞–Ω —Å —Å–µ—Ä–≤–µ—Ä–∞, –ø—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –µ–≥–æ –∏–∑ –¥—Ä—É–≥–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
        if (!domain) {
          const urlInput = document.getElementById('url').value;
          try {
            if (urlInput) {
              const urlObj = new URL(urlInput);
              domain = urlObj.hostname;
            } else if (jsonData.url) {
              const urlObj = new URL(jsonData.url);
              domain = urlObj.hostname;
            } else {
              domain = 'example.com';
            }
          } catch (e) {
            domain = 'example.com';
          }
        }
        
        // –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –º–∏–∫—Ä–æ—Ä–∞–∑–º–µ—Ç–∫–∏ —Å–æ–∑–¥–∞–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä
        switch (type) {
          case 'LocalBusiness':
            createLocalBusinessSnippet(snippetContainer, jsonData, domain);
            break;
          case 'Product':
            createProductSnippet(snippetContainer, jsonData, domain);
            break;
          case 'CollectionPage':
            createCollectionSnippet(snippetContainer, jsonData, domain);
            break;
          case 'FAQPage':
            createFAQSnippet(snippetContainer, jsonData, domain);
            break;
          case 'QAPage':
            createQASnippet(snippetContainer, jsonData, domain);
            break;
          case 'BreadcrumbList':
            createBreadcrumbsSnippet(snippetContainer, jsonData, domain);
            break;
          default:
            createDefaultSnippet(snippetContainer, jsonData, domain);
        }
      } else {
        // –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ JSON-LD
        snippetContainer.innerHTML = `
          <div class="google-snippet-placeholder text-center py-3">
            <i class="bi bi-exclamation-triangle text-warning me-2"></i>
            <span class="text-muted">–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å –º–∏–∫—Ä–æ—Ä–∞–∑–º–µ—Ç–∫—É –¥–ª—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞</span>
          </div>
        `;
      }
    } catch (e) {
      console.warn('–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å –º–∏–∫—Ä–æ—Ä–∞–∑–º–µ—Ç–∫—É:', e);
      snippetContainer.innerHTML = `
        <div class="google-snippet-placeholder text-center py-3">
          <i class="bi bi-exclamation-triangle text-warning me-2"></i>
          <span class="text-muted">–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞: ${e.message}</span>
        </div>
      `;
    }
  }
  
  // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤
  function createLocalBusinessSnippet(container, data, domain) {
    const address = data.address ? 
      [data.address.addressLocality, data.address.streetAddress].filter(Boolean).join(', ') : 
      '–ú–æ—Å–∫–≤–∞, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, 123';
    
    const phone = data.telephone || '+7 (XXX) XXX-XX-XX';
    const hours = data.openingHours || '–ü–Ω-–ü—Ç: 9:00-18:00';
    
    container.innerHTML = `
      <div class="google-snippet">
        <div class="snippet-title text-primary fw-bold">${domain} - –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</div>
        <div class="snippet-url text-success small mb-1">${data.url || 'https://' + domain}</div>
        <div class="snippet-description text-dark small">
          <div><i class="bi bi-geo-alt text-secondary me-1"></i> –ê–¥—Ä–µ—Å: <span class="snippet-address">${address}</span></div>
          <div><i class="bi bi-telephone text-secondary me-1"></i> –¢–µ–ª–µ—Ñ–æ–Ω: <span class="snippet-phone">${phone}</span></div>
          <div><i class="bi bi-clock text-secondary me-1"></i> –ß–∞—Å—ã —Ä–∞–±–æ—Ç—ã: <span class="snippet-hours">${hours}</span></div>
        </div>
      </div>
    `;
  }
  
  function createProductSnippet(container, data, domain) {
    let price = '15 990';
    let currency = '‚ÇΩ';
    
    if (data.offers) {
      if (data.offers.price) {
        price = formatPrice(data.offers.price);
        currency = data.offers.priceCurrency === 'RUB' ? '‚ÇΩ' : (data.offers.priceCurrency || '‚ÇΩ');
      }
    }
    
    container.innerHTML = `
      <div class="google-snippet">
        <div class="snippet-title text-primary fw-bold">${data.name || '–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞'} - ${domain}</div>
        <div class="snippet-url text-success small mb-1">${data.url || 'https://' + domain}</div>
        <div class="snippet-description text-dark small">
          <div class="d-flex align-items-center mb-1">
            <div class="snippet-rating">
              <span class="text-warning">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
            </div>
            <span class="snippet-reviews ms-1">(123 –æ—Ç–∑—ã–≤–∞)</span>
            <span class="snippet-price ms-2 fw-bold">${price} ${currency}</span>
          </div>
          <div>–í –Ω–∞–ª–∏—á–∏–∏ ¬∑ –ë—ã—Å—Ç—Ä–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞</div>
        </div>
      </div>
    `;
  }
  
  function createCollectionSnippet(container, data, domain) {
    let lowPrice = '5 000';
    let highPrice = '150 000';
    let currency = '‚ÇΩ';
    
    if (data.mainEntity && data.mainEntity.offers) {
      const offers = data.mainEntity.offers;
      if (offers.lowPrice && offers.highPrice) {
        lowPrice = formatPrice(offers.lowPrice);
        highPrice = formatPrice(offers.highPrice);
        currency = offers.priceCurrency === 'RUB' ? '‚ÇΩ' : (offers.priceCurrency || '‚ÇΩ');
      }
    }
    
    container.innerHTML = `
      <div class="google-snippet">
        <div class="snippet-title text-primary fw-bold">${data.name || '–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤'} - ${domain}</div>
        <div class="snippet-url text-success small mb-1">${data.url || 'https://' + domain}</div>
        <div class="snippet-description text-dark small">
          <div class="d-flex align-items-center mb-1">
            <div class="snippet-rating">
              <span class="text-warning">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
            </div>
            <span class="snippet-reviews ms-1">(324 –æ—Ç–∑—ã–≤–∞)</span>
          </div>
          <div>–¶–µ–Ω—ã: <span class="fw-bold">–æ—Ç ${lowPrice}${currency} –¥–æ ${highPrice}${currency}</span> ¬∑ 125 —Ç–æ–≤–∞—Ä–æ–≤</div>
        </div>
      </div>
    `;
  }
  
  function createFAQSnippet(container, data, domain) {
    let faqItems = '';
    
    if (data.mainEntity && Array.isArray(data.mainEntity)) {
      // –ë–µ—Ä–µ–º –ø–µ—Ä–≤—ã–µ 2 –≤–æ–ø—Ä–æ—Å–∞ –¥–ª—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞
      const questions = data.mainEntity.slice(0, 2);
      
      faqItems = questions.map((q, index) => {
        const answer = q.acceptedAnswer.text.length > 60 
          ? q.acceptedAnswer.text.substring(0, 60) + '...' 
          : q.acceptedAnswer.text;
          
        return `
          <div class="faq-item${index < questions.length - 1 ? ' mb-2' : ''}">
            <div class="fw-bold">${q.name}</div>
            <div>${answer}</div>
          </div>
        `;
      }).join('');
    } else {
      faqItems = `
        <div class="faq-item mb-2">
          <div class="fw-bold">–ö–∞–∫ —Å–¥–µ–ª–∞—Ç—å –∑–∞–∫–∞–∑?</div>
          <div>–î–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ –¥–æ–±–∞–≤—å—Ç–µ —Ç–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω—É –∏ —Å–ª–µ–¥—É–π—Ç–µ...</div>
        </div>
        <div class="faq-item">
          <div class="fw-bold">–ö–∞–∫–∏–µ —Å–ø–æ—Å–æ–±—ã –¥–æ—Å—Ç–∞–≤–∫–∏ –≤—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç–µ?</div>
          <div>–ú—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º –∫—É—Ä—å–µ—Ä—Å–∫—É—é –¥–æ—Å—Ç–∞–≤–∫—É, —Å–∞–º–æ–≤—ã–≤–æ–∑ –∏–∑ –Ω–∞—à–∏—Ö...</div>
        </div>
      `;
    }
    
    container.innerHTML = `
      <div class="google-snippet">
        <div class="snippet-title text-primary fw-bold">–ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã - ${domain}</div>
        <div class="snippet-url text-success small mb-1">${data.url || 'https://' + domain}</div>
        <div class="snippet-description text-dark small">
          <div class="snippet-faq">
            ${faqItems}
          </div>
        </div>
      </div>
    `;
  }
  
  function createQASnippet(container, data, domain) {
    let questionName = '–¢–æ–≤–∞—Ä—ã';
    let answerText = '‚≠ê –í—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤ üíé –î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ –≤—Å–µ–π –†–æ—Å—Å–∏–∏ üíé –í—ã–≥–æ–¥–Ω–∞—è –±–æ–Ω—É—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞';
    let upvoteCount = 26;
    let answerCount = 1;
    
    if (data.mainEntity) {
      if (data.mainEntity.name) {
        questionName = data.mainEntity.name;
      }
      
      if (data.mainEntity.acceptedAnswer && data.mainEntity.acceptedAnswer.text) {
        answerText = data.mainEntity.acceptedAnswer.text;
      }
      
      if (data.mainEntity.upvoteCount) {
        upvoteCount = data.mainEntity.upvoteCount;
      } else if (data.mainEntity.acceptedAnswer && data.mainEntity.acceptedAnswer.upvoteCount) {
        upvoteCount = data.mainEntity.acceptedAnswer.upvoteCount;
      }
      
      if (data.mainEntity.answerCount) {
        answerCount = data.mainEntity.answerCount;
      }
    }
    
    container.innerHTML = `
      <div class="google-snippet">
        <div class="snippet-title text-primary fw-bold">${domain} - –í–æ–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã</div>
        <div class="snippet-url text-success small mb-1">${data.url || 'https://' + domain}</div>
        <div class="snippet-description text-dark small">
          <div class="fw-bold mb-1">${questionName}</div>
          <div class="mb-1">${answerText}</div>
          <div class="text-secondary small">
            <span>${upvoteCount} —á–µ–ª–æ–≤–µ–∫ –Ω–∞—à–ª–∏ –æ—Ç–≤–µ—Ç –ø–æ–ª–µ–∑–Ω—ã–º</span>
            <span class="ms-3">–û—Ç–≤–µ—Ç–æ–≤: ${answerCount}</span>
          </div>
        </div>
      </div>
    `;
  }
  
  function createBreadcrumbsSnippet(container, data, domain) {
    let breadcrumbs = '–ì–ª–∞–≤–Ω–∞—è > –ö–∞—Ç–∞–ª–æ–≥ > üì¶üì¶üì¶ –ö–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–æ–≤–∞—Ä–æ–≤ > –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è';
    
    if (data.itemListElement && Array.isArray(data.itemListElement)) {
      breadcrumbs = data.itemListElement.map(item => item.name).join(' > ');
    }
    
    container.innerHTML = `
      <div class="google-snippet">
        <div class="snippet-title text-primary fw-bold">–ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã - ${domain}</div>
        <div class="snippet-url text-success small mb-1">${data.url || 'https://' + domain}</div>
        <div class="snippet-description text-dark small">
          <div class="breadcrumbs small text-secondary">
            ${breadcrumbs}
          </div>
          <div>–û–ø–∏—Å–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å —Ö–ª–µ–±–Ω—ã–º–∏ –∫—Ä–æ—à–∫–∞–º–∏.</div>
        </div>
      </div>
    `;
  }
  
  function createDefaultSnippet(container, data, domain) {
    container.innerHTML = `
      <div class="google-snippet">
        <div class="snippet-title text-primary fw-bold">${data.name || domain}</div>
        <div class="snippet-url text-success small mb-1">${data.url || 'https://' + domain}</div>
        <div class="snippet-description text-dark small">
          ${data.description || '–û–ø–∏—Å–∞–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –≤ –º–∏–∫—Ä–æ—Ä–∞–∑–º–µ—Ç–∫–µ'}
        </div>
      </div>
    `;
  }
  
  // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ü–µ–Ω—ã
  function formatPrice(price) {
    // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —á–∏—Å–ª–æ –±–µ–∑ –≤–∞–ª—é—Ç—ã, —É–±–∏—Ä–∞–µ–º –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–µ–ª—ã –≤ –∫–æ–Ω—Ü–µ
    return parseFloat(price).toLocaleString('ru-RU').trim();
  }
  
  // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö —Å–Ω–∏–ø–ø–µ—Ç–∞
  let currentSnippetType = '';
  let currentSnippetData = null;
  
  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–Ω–∏–ø–ø–µ—Ç–∞
  document.getElementById('editSnippetBtn').addEventListener('click', function() {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–Ω–∏–ø–ø–µ—Ç
    const snippetContainer = document.getElementById('singleSnippet');
    const snippetTitle = snippetContainer.querySelector('.snippet-title');
    
    if (!snippetTitle || snippetContainer.querySelector('.google-snippet-placeholder')) {
      alert('–°–Ω–∞—á–∞–ª–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –º–∏–∫—Ä–æ—Ä–∞–∑–º–µ—Ç–∫—É –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä–∞');
      return;
    }
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    document.getElementById('snippetEditForm').style.display = 'block';
    
    // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É —Ç–µ–∫—É—â–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ —Å–Ω–∏–ø–ø–µ—Ç–∞
    fillEditForm();
  });
  
  // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–µ–∫—É—â–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ —Å–Ω–∏–ø–ø–µ—Ç–∞
  function fillEditForm() {
    const snippetContainer = document.getElementById('singleSnippet');
    const snippetTitle = snippetContainer.querySelector('.snippet-title');
    const snippetUrl = snippetContainer.querySelector('.snippet-url');
    const snippetDescription = snippetContainer.querySelector('.snippet-description');
    
    // –ó–∞–ø–æ–ª–Ω—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è
    document.getElementById('snippetTitle').value = snippetTitle ? snippetTitle.textContent : '';
    document.getElementById('snippetUrl').value = snippetUrl ? snippetUrl.textContent : '';
    
    // –î–ª—è –æ–ø–∏—Å–∞–Ω–∏—è –±–µ—Ä–µ–º —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ, –Ω–æ –Ω–µ –≤—Å–µ HTML
    let descriptionText = '';
    if (snippetDescription) {
      // –ö–ª–æ–Ω–∏—Ä—É–µ–º —ç–ª–µ–º–µ–Ω—Ç, —á—Ç–æ–±—ã –Ω–µ –º–µ–Ω—è—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π
      const descClone = snippetDescription.cloneNode(true);
      
      // –ó–∞–º–µ–Ω—è–µ–º HTML —Ç–µ–≥–∏ –Ω–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è
      const paragraphs = descClone.querySelectorAll('div:not(.d-flex, .snippet-rating)');
      paragraphs.forEach(p => {
        descriptionText += p.textContent.trim() + '\n';
      });
      
      document.getElementById('snippetDescription').value = descriptionText.trim();
    }
    
    // –û—á–∏—â–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
    document.getElementById('additionalFields').innerHTML = '';
    
    // –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ —Å–Ω–∏–ø–ø–µ—Ç–∞ –¥–æ–±–∞–≤–ª—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
    if (currentSnippetType === 'Product') {
      addProductFields(snippetContainer);
    } else if (currentSnippetType === 'CollectionPage') {
      addCollectionFields(snippetContainer);
    } else if (currentSnippetType === 'FAQPage') {
      addFAQFields(snippetContainer);
    } else if (currentSnippetType === 'LocalBusiness') {
      addLocalBusinessFields(snippetContainer);
    } else if (currentSnippetType === 'QAPage') {
      addQAFields(snippetContainer);
    } else if (currentSnippetType === 'BreadcrumbList') {
      addBreadcrumbsFields(snippetContainer);
    }
  }
  
  // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª–µ–π –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–Ω–∏–ø–ø–µ—Ç–æ–≤
  function addProductFields(snippetContainer) {
    const priceEl = snippetContainer.querySelector('.snippet-price');
    const additionalFields = document.getElementById('additionalFields');
    
    const priceValue = priceEl ? priceEl.textContent.trim().replace(/[^\d\s,]/g, '') : '';
    
    additionalFields.innerHTML = `
      <div class="mb-3">
        <label for="snippetPrice" class="form-label">–¶–µ–Ω–∞:</label>
        <input type="text" class="form-control" id="snippetPrice" value="${priceValue}">
      </div>
      <div class="mb-3">
        <label for="snippetRating" class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∑—ã–≤–æ–≤:</label>
        <input type="number" class="form-control" id="snippetRating" min="0" value="123">
      </div>
      <div class="form-check mb-3">
        <input class="form-check-input" type="checkbox" id="snippetInStock" checked>
        <label class="form-check-label" for="snippetInStock">
          –í –Ω–∞–ª–∏—á–∏–∏
        </label>
      </div>
    `;
  }
  
  function addCollectionFields(snippetContainer) {
    const priceText = snippetContainer.querySelector('.fw-bold');
    const additionalFields = document.getElementById('additionalFields');
    
    let lowPrice = '5000';
    let highPrice = '150000';
    
    if (priceText) {
      const priceMatch = priceText.textContent.match(/–æ—Ç\s+(\d[\d\s,]+)‚ÇΩ\s+–¥–æ\s+(\d[\d\s,]+)‚ÇΩ/);
      if (priceMatch) {
        lowPrice = priceMatch[1].replace(/\s/g, '');
        highPrice = priceMatch[2].replace(/\s/g, '');
      }
    }
    
    additionalFields.innerHTML = `
      <div class="mb-3">
        <label for="snippetLowPrice" class="form-label">–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞:</label>
        <input type="text" class="form-control" id="snippetLowPrice" value="${lowPrice}">
      </div>
      <div class="mb-3">
        <label for="snippetHighPrice" class="form-label">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞:</label>
        <input type="text" class="form-control" id="snippetHighPrice" value="${highPrice}">
      </div>
      <div class="mb-3">
        <label for="snippetOfferCount" class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–≤–∞—Ä–æ–≤:</label>
        <input type="number" class="form-control" id="snippetOfferCount" min="1" value="125">
      </div>
    `;
  }
  
  function addFAQFields(snippetContainer) {
    const faqItems = snippetContainer.querySelectorAll('.faq-item');
    const additionalFields = document.getElementById('additionalFields');
    
    let faqHtml = '<div class="mb-3"><label class="form-label">–í–æ–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã:</label>';
    
    if (faqItems.length) {
      faqItems.forEach((item, index) => {
        const question = item.querySelector('.fw-bold').textContent;
        const answer = item.querySelector('div:not(.fw-bold)').textContent;
        
        faqHtml += `
          <div class="card mb-2">
            <div class="card-body">
              <div class="mb-2">
                <label for="faqQuestion${index}" class="form-label">–í–æ–ø—Ä–æ—Å ${index + 1}:</label>
                <input type="text" class="form-control" id="faqQuestion${index}" value="${question}">
              </div>
              <div class="mb-2">
                <label for="faqAnswer${index}" class="form-label">–û—Ç–≤–µ—Ç ${index + 1}:</label>
                <textarea class="form-control" id="faqAnswer${index}" rows="2">${answer}</textarea>
              </div>
            </div>
          </div>
        `;
      });
    } else {
      // –ï—Å–ª–∏ –Ω–µ—Ç –≤–æ–ø—Ä–æ—Å–æ–≤, –¥–æ–±–∞–≤–ª—è–µ–º 2 –ø—É—Å—Ç—ã—Ö
      for (let i = 0; i < 2; i++) {
        faqHtml += `
          <div class="card mb-2">
            <div class="card-body">
              <div class="mb-2">
                <label for="faqQuestion${i}" class="form-label">–í–æ–ø—Ä–æ—Å ${i + 1}:</label>
                <input type="text" class="form-control" id="faqQuestion${i}" value="">
              </div>
              <div class="mb-2">
                <label for="faqAnswer${i}" class="form-label">–û—Ç–≤–µ—Ç ${i + 1}:</label>
                <textarea class="form-control" id="faqAnswer${i}" rows="2"></textarea>
              </div>
            </div>
          </div>
        `;
      }
    }
    
    faqHtml += '</div>';
    additionalFields.innerHTML = faqHtml;
  }
  
  function addLocalBusinessFields(snippetContainer) {
    const addressEl = snippetContainer.querySelector('.snippet-address');
    const phoneEl = snippetContainer.querySelector('.snippet-phone');
    const hoursEl = snippetContainer.querySelector('.snippet-hours');
    
    const additionalFields = document.getElementById('additionalFields');
    
    additionalFields.innerHTML = `
      <div class="mb-3">
        <label for="snippetAddress" class="form-label">–ê–¥—Ä–µ—Å:</label>
        <input type="text" class="form-control" id="snippetAddress" value="${addressEl ? addressEl.textContent : ''}">
      </div>
      <div class="mb-3">
        <label for="snippetPhone" class="form-label">–¢–µ–ª–µ—Ñ–æ–Ω:</label>
        <input type="text" class="form-control" id="snippetPhone" value="${phoneEl ? phoneEl.textContent : ''}">
      </div>
      <div class="mb-3">
        <label for="snippetHours" class="form-label">–ß–∞—Å—ã —Ä–∞–±–æ—Ç—ã:</label>
        <input type="text" class="form-control" id="snippetHours" value="${hoursEl ? hoursEl.textContent : ''}">
      </div>
    `;
  }
  
  function addQAFields(snippetContainer) {
    const questionEl = snippetContainer.querySelector('.fw-bold');
    const answerEl = snippetContainer.querySelector('.mb-1:not(.fw-bold)');
    const upvoteEl = snippetContainer.querySelector('.text-secondary');
    
    let upvoteText = upvoteEl ? upvoteEl.textContent : '';
    let upvoteMatch = upvoteText.match(/(\d+)/);
    let upvoteCount = upvoteMatch ? upvoteMatch[1] : '26';
    
    let answerCountMatch = upvoteText.match(/–û—Ç–≤–µ—Ç–æ–≤: (\d+)/);
    let answerCount = answerCountMatch ? answerCountMatch[1] : '1';
    
    const additionalFields = document.getElementById('additionalFields');
    
    additionalFields.innerHTML = `
      <div class="mb-3">
        <label for="snippetQuestion" class="form-label">–í–æ–ø—Ä–æ—Å:</label>
        <input type="text" class="form-control" id="snippetQuestion" value="${questionEl ? questionEl.textContent : ''}">
      </div>
      <div class="mb-3">
        <label for="snippetAnswer" class="form-label">–û—Ç–≤–µ—Ç:</label>
        <textarea class="form-control" id="snippetAnswer" rows="3">${answerEl ? answerEl.textContent : ''}</textarea>
      </div>
      <div class="row">
        <div class="col-md-6 mb-3">
          <label for="snippetUpvotes" class="form-label">–ì–æ–ª–æ—Å–∞ –∑–∞ –æ—Ç–≤–µ—Ç:</label>
          <input type="number" class="form-control" id="snippetUpvotes" min="0" value="${upvoteCount}">
        </div>
        <div class="col-md-6 mb-3">
          <label for="snippetAnswerCount" class="form-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–≤–µ—Ç–æ–≤:</label>
          <input type="number" class="form-control" id="snippetAnswerCount" min="1" value="${answerCount}">
        </div>
      </div>
    `;
  }
  
  function addBreadcrumbsFields(snippetContainer) {
    const breadcrumbsEl = snippetContainer.querySelector('.breadcrumbs');
    const breadcrumbsText = breadcrumbsEl ? breadcrumbsEl.textContent : '–ì–ª–∞–≤–Ω–∞—è > –ö–∞—Ç–∞–ª–æ–≥ > –ö–∞—Ç–µ–≥–æ—Ä–∏—è > –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è';
    
    const breadcrumbs = breadcrumbsText.split('>').map(item => item.trim());
    
    const additionalFields = document.getElementById('additionalFields');
    
    let breadcrumbsHtml = '<div class="mb-3"><label class="form-label">–•–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏:</label>';
    
    breadcrumbs.forEach((crumb, index) => {
      breadcrumbsHtml += `
        <div class="input-group mb-2">
          <span class="input-group-text">${index + 1}</span>
          <input type="text" class="form-control" id="breadcrumb${index}" value="${crumb}">
        </div>
      `;
    });
    
    breadcrumbsHtml += '</div>';
    additionalFields.innerHTML = breadcrumbsHtml;
  }
  
  // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫ –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä—É —Å–Ω–∏–ø–ø–µ—Ç–∞
  document.getElementById('applySnippetChangesBtn').addEventListener('click', function() {
    // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —Ñ–æ—Ä–º—ã
    const title = document.getElementById('snippetTitle').value;
    const url = document.getElementById('snippetUrl').value;
    const description = document.getElementById('snippetDescription').value;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–Ω–∏–ø–ø–µ—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞
    const snippetContainer = document.getElementById('singleSnippet');
    const snippetTitle = snippetContainer.querySelector('.snippet-title');
    const snippetUrl = snippetContainer.querySelector('.snippet-url');
    
    if (snippetTitle) snippetTitle.textContent = title;
    if (snippetUrl) snippetUrl.textContent = url;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –ø–æ–ª—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ —Å–Ω–∏–ø–ø–µ—Ç–∞
    if (currentSnippetType === 'Product') {
      updateProductSnippet(snippetContainer, description);
    } else if (currentSnippetType === 'CollectionPage') {
      updateCollectionSnippet(snippetContainer, description);
    } else if (currentSnippetType === 'FAQPage') {
      updateFAQSnippet(snippetContainer);
    } else if (currentSnippetType === 'LocalBusiness') {
      updateLocalBusinessSnippet(snippetContainer);
    } else if (currentSnippetType === 'QAPage') {
      updateQASnippet(snippetContainer);
    } else if (currentSnippetType === 'BreadcrumbList') {
      updateBreadcrumbsSnippet(snippetContainer, description);
    } else {
      // –î–ª—è –æ–±—â–µ–≥–æ —Å–ª—É—á–∞—è –ø—Ä–æ—Å—Ç–æ –æ–±–Ω–æ–≤–ª—è–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ
      const descriptionEl = snippetContainer.querySelector('.snippet-description');
      if (descriptionEl) descriptionEl.textContent = description;
    }
    
    // –°–∫—Ä—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    document.getElementById('snippetEditForm').style.display = 'none';
  });
  
  // –§—É–Ω–∫—Ü–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–Ω–∏–ø–ø–µ—Ç–æ–≤
  function updateProductSnippet(container, description) {
    const price = document.getElementById('snippetPrice').value;
    const rating = document.getElementById('snippetRating').value;
    const inStock = document.getElementById('snippetInStock').checked;
    
    const priceEl = container.querySelector('.snippet-price');
    const reviewsEl = container.querySelector('.snippet-reviews');
    const statusEl = container.querySelector('.snippet-description > div:nth-child(2)');
    
    if (priceEl) priceEl.textContent = `${price}‚ÇΩ`;
    if (reviewsEl) reviewsEl.textContent = `(${rating} –æ—Ç–∑—ã–≤–∞)`;
    if (statusEl) statusEl.textContent = inStock ? '–í –Ω–∞–ª–∏—á–∏–∏ ¬∑ –ë—ã—Å—Ç—Ä–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞' : '–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏';
  }
  
  function updateCollectionSnippet(container, description) {
    const lowPrice = document.getElementById('snippetLowPrice').value;
    const highPrice = document.getElementById('snippetHighPrice').value;
    const offerCount = document.getElementById('snippetOfferCount').value;
    
    const priceEl = container.querySelector('.fw-bold');
    const reviewsEl = container.querySelector('.snippet-reviews');
    
    if (priceEl) {
      const formattedLowPrice = formatPrice(lowPrice);
      const formattedHighPrice = formatPrice(highPrice);
      priceEl.textContent = `–æ—Ç ${formattedLowPrice}‚ÇΩ –¥–æ ${formattedHighPrice}‚ÇΩ`;
    }
    
    if (reviewsEl) reviewsEl.textContent = `(324 –æ—Ç–∑—ã–≤–∞)`;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ç–æ–≤–∞—Ä–æ–≤
    const priceRow = container.querySelector('.snippet-description > div:nth-child(2)');
    if (priceRow) {
      const priceSpan = priceRow.querySelector('.fw-bold');
      const priceText = priceSpan ? priceSpan.outerHTML : `<span class="fw-bold">–æ—Ç ${formatPrice(lowPrice)}‚ÇΩ –¥–æ ${formatPrice(highPrice)}‚ÇΩ</span>`;
      priceRow.innerHTML = `–¶–µ–Ω—ã: ${priceText} ¬∑ ${offerCount} —Ç–æ–≤–∞—Ä–æ–≤`;
    }
  }
  
  function updateFAQSnippet(container) {
    const faqContainer = container.querySelector('.snippet-faq');
    if (!faqContainer) return;
    
    faqContainer.innerHTML = '';
    
    // –ü–æ–ª—É—á–∞–µ–º –≤–æ–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã –∏–∑ —Ñ–æ—Ä–º—ã
    const questions = [];
    const answers = [];
    
    // –ò—â–µ–º –≤—Å–µ –ø–æ–ª—è —Å –≤–æ–ø—Ä–æ—Å–∞–º–∏ –∏ –æ—Ç–≤–µ—Ç–∞–º–∏
    const questionInputs = document.querySelectorAll('[id^="faqQuestion"]');
    const answerInputs = document.querySelectorAll('[id^="faqAnswer"]');
    
    for (let i = 0; i < questionInputs.length; i++) {
      if (questionInputs[i].value && answerInputs[i].value) {
        questions.push(questionInputs[i].value);
        answers.push(answerInputs[i].value);
      }
    }
    
    // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤
    for (let i = 0; i < questions.length; i++) {
      const faqItem = document.createElement('div');
      faqItem.className = 'faq-item' + (i < questions.length - 1 ? ' mb-2' : '');
      
      const questionEl = document.createElement('div');
      questionEl.className = 'fw-bold';
      questionEl.textContent = questions[i];
      
      const answerEl = document.createElement('div');
      answerEl.textContent = answers[i].length > 60 ? answers[i].substring(0, 60) + '...' : answers[i];
      
      faqItem.appendChild(questionEl);
      faqItem.appendChild(answerEl);
      faqContainer.appendChild(faqItem);
    }
  }
  
  function updateLocalBusinessSnippet(container) {
    const address = document.getElementById('snippetAddress').value;
    const phone = document.getElementById('snippetPhone').value;
    const hours = document.getElementById('snippetHours').value;
    
    const addressEl = container.querySelector('.snippet-address');
    const phoneEl = container.querySelector('.snippet-phone');
    const hoursEl = container.querySelector('.snippet-hours');
    
    if (addressEl) addressEl.textContent = address;
    if (phoneEl) phoneEl.textContent = phone;
    if (hoursEl) hoursEl.textContent = hours;
  }
  
  function updateQASnippet(container) {
    const question = document.getElementById('snippetQuestion').value;
    const answer = document.getElementById('snippetAnswer').value;
    const upvotes = document.getElementById('snippetUpvotes').value;
    const answerCount = document.getElementById('snippetAnswerCount').value;
    
    const questionEl = container.querySelector('.fw-bold');
    const answerEl = container.querySelector('.mb-1:not(.fw-bold)');
    const upvotesEl = container.querySelector('.text-secondary');
    
    if (questionEl) questionEl.textContent = question;
    if (answerEl) answerEl.textContent = answer;
    
    if (upvotesEl) {
      const spans = upvotesEl.querySelectorAll('span');
      if (spans.length >= 2) {
        spans[0].textContent = `${upvotes} —á–µ–ª–æ–≤–µ–∫ –Ω–∞—à–ª–∏ –æ—Ç–≤–µ—Ç –ø–æ–ª–µ–∑–Ω—ã–º`;
        spans[1].textContent = `–û—Ç–≤–µ—Ç–æ–≤: ${answerCount}`;
      }
    }
  }
  
  function updateBreadcrumbsSnippet(container, description) {
    const breadcrumbsEl = container.querySelector('.breadcrumbs');
    if (!breadcrumbsEl) return;
    
    // –ü–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è —Ö–ª–µ–±–Ω—ã—Ö –∫—Ä–æ—à–µ–∫ –∏–∑ —Ñ–æ—Ä–º—ã
    const breadcrumbs = [];
    const breadcrumbInputs = document.querySelectorAll('[id^="breadcrumb"]');
    
    breadcrumbInputs.forEach(input => {
      if (input.value) {
        breadcrumbs.push(input.value);
      }
    });
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Ö–ª–µ–±–Ω—ã–µ –∫—Ä–æ—à–∫–∏
    breadcrumbsEl.textContent = breadcrumbs.join(' > ');
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ, –µ—Å–ª–∏ –µ—Å—Ç—å
    const descriptionEl = container.querySelector('.snippet-description > div:nth-child(2)');
    if (descriptionEl && description) {
      descriptionEl.textContent = description;
    }
  }
  
  // –û—Ç–º–µ–Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–Ω–∏–ø–ø–µ—Ç–∞
  document.getElementById('cancelSnippetEditBtn').addEventListener('click', function() {
    document.getElementById('snippetEditForm').style.display = 'none';
  });
</script>
</body>
</html>